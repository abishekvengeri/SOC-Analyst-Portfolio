title: Potential Encoded PowerShell Execution
id: a1f6c2b8-0000-4d3a-9f6a-EXAMPLE
status: experimental
description: Detects PowerShell started with encoded command arguments which is often used to obfuscate scripts.
author: Your Name
date: 2025-12-09
references:
  - https://attack.mitre.org/techniques/T1059/001/
tags:
  - attack.execution
  - technique:T1059.001
logsource:
  product: windows
  service: sysmon
detection:
  selection:
    EventID: 1
    ProcessName|endswith: 
      - '\powershell.exe'
      - '\pwsh.exe'
    CommandLine|contains:
      - '-EncodedCommand'
      - '-enc'
      - 'IEX'
  condition: selection
fields:
  - TimeCreated
  - Computer
  - ProcessName
  - CommandLine
falsepositives:
  - Admins using encoded commands for legitimate tasks or automated scripts
level: medium

